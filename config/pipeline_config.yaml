# Formula 1 Data Pipeline Configuration
# This configuration file manages Unity Catalog settings and pipeline parameters

# Unity Catalog Configuration
unity_catalog:
  catalog: "jai_patel_f1_data" # Change this to your catalog name
  schema: "racing_stats" # Change this to your schema name
  volume: "raw_data" # Volume for storing raw JSON files (optional)

# API Configuration
api:
  base_url: "https://api.openf1.org/v1"
  rate_limit_delay: 2 # Seconds between API calls (increased to avoid 429 errors)
  timeout: 30 # Request timeout in seconds
  retry_attempts: 5 # Number of retry attempts for failed requests (increased for rate limits)

  # Parallel processing configuration
  parallel_endpoints: true # Enable parallel fetching of different endpoints
  max_workers: 3 # Max parallel threads for endpoint fetching (3-5 recommended)
  parallel_sessions: false # Enable parallel fetching within endpoints (use with caution)

# Data Configuration
data:
  target_year: 2025 # Year to fetch data for (2024 has complete data, 2025 might be incomplete)
  batch_size: 1000 # Records per batch for large datasets

  # Car data filtering (to reduce API response size)
  car_data_filters:
    speed_gte: 100 # Only fetch data when speed >= 100 km/h (reduces ~40% of data)
    sample_drivers: true # Only fetch data for first 5 drivers per session (for testing)

  # Incremental storage options
  use_volume_staging: true # Write data to volume files incrementally before loading to Delta
  volume_path: "pipeline_storage/staging" # Path within volume for staging files

# Pipeline Configuration
pipeline:
  target: "production" # Target environment: development, staging, production
  storage_location: "/Volumes/jai_patel_f1_data/racing_stats/pipeline_storage" # Unity Catalog Volume location for checkpoints

# Endpoints to fetch (set to true to enable)
endpoints:
  sessions: true
  drivers: true
  meetings: true
  laps: true
  car_data: true # Note: May not be available for all sessions (especially future/recent races)
  position: true # Note: May not be available for all sessions
  pit: true
  stints: true
  weather: true
  race_control: true
  team_radio: true
  intervals: true
  location: false # Disabled by default (very large dataset)
  overtakes: true
  session_result: true
  starting_grid: true
